<!doctype html>
<html lang="en-us">
  <head>
    <title>Penetration Testing Wifi Pt.1 - Capture handshake using Airmon-ng - Kali Linux // Layer 8 Tech Stuff</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.89.4" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Andrew" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.3c515c1473ba60424e046cfd164d618aa2d99cdd53c3e015fe17860c0657c0f1.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Penetration Testing Wifi Pt.1 - Capture handshake using Airmon-ng - Kali Linux"/>
<meta name="twitter:description" content="Authored by AH License Notice This article is published under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) license.
Table of Contents  Introduction 0. Pre-preparation 0-1 Pre-preparation Reading 0-2 Acquire necessary devices 0-3 Notes 1. Enable Monitor Mode 2. Scan for Networks 3. Scan Test Network 4. Capture Test Network WPA2 Handshake 5. Verify the captured WPA2 handshake 6. Stop Monitor Mode on WiFi adapter   Â Introduction This turorial intends to demostrate the first portion WiFi penetration testing using Airmon-ng manually to capture WPA2 handshake by showing each step of the processwith pictures."/>

    <meta property="og:title" content="Penetration Testing Wifi Pt.1 - Capture handshake using Airmon-ng - Kali Linux" />
<meta property="og:description" content="Authored by AH License Notice This article is published under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) license.
Table of Contents  Introduction 0. Pre-preparation 0-1 Pre-preparation Reading 0-2 Acquire necessary devices 0-3 Notes 1. Enable Monitor Mode 2. Scan for Networks 3. Scan Test Network 4. Capture Test Network WPA2 Handshake 5. Verify the captured WPA2 handshake 6. Stop Monitor Mode on WiFi adapter   Â Introduction This turorial intends to demostrate the first portion WiFi penetration testing using Airmon-ng manually to capture WPA2 handshake by showing each step of the processwith pictures." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/pentest-wifi-airmon-ng-with-kali-linux-pt1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-09-16T00:00:00+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Andrew" /></a>
      <h1>Layer 8 Tech Stuff</h1>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Articles</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">Article Tags</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">About Me</a>
      </nav>
      <p>Hi ðŸ‘‹, I am A.H., a computer technology, smartphones, cybersecurity, digital privacy, and digital forensics enthusiast. This website is dedicated for documenting these interests and sharing them on the web ðŸ˜„.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/ahlayer8tech" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="mailto:ahlayer8tech.vcaco@aleeas.com" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-mail">
  <title>Contact Email</title>
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Penetration Testing Wifi Pt.1 - Capture handshake using Airmon-ng - Kali Linux</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Sep 16, 2022
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          6 min read
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="/tags/pentest/">pentest</a>
              <a class="tag" href="/tags/linux/">Linux</a>
              <a class="tag" href="/tags/wifi/">WiFi </a>
              <a class="tag" href="/tags/kali/">Kali</a>
              <a class="tag" href="/tags/airmon-ng/">Airmon-ng</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h4 id="authored-by-ah">Authored by AH</h4>
<h3 id="license-notice">License Notice</h3>
<p>This article is published under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) license</a>.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#0-pre-preparation">0. Pre-preparation</a></li>
<li><a href="#0-1-pre-preparation-reading">0-1 Pre-preparation Reading</a></li>
<li><a href="#0-2-acquire-necessary-devices">0-2 Acquire necessary devices</a></li>
<li><a href="#0-3-notes">0-3 Notes</a></li>
<li><a href="#1-enable-monitor-mode">1. Enable Monitor Mode</a></li>
<li><a href="#2-scan-for-networks">2. Scan for Networks</a></li>
<li><a href="#3-scan-test-network">3. Scan Test Network</a></li>
<li><a href="#4-capture-test-network-wpa2-handshake">4. Capture Test Network WPA2 Handshake</a></li>
<li><a href="#5-verify-the-captured-wpa2-handshake">5. Verify the captured WPA2 handshake</a></li>
<li><a href="#6-stop-monitor-mode-on-wifi-adapter">6. Stop Monitor Mode on WiFi adapter</a></li>
<li><a href="#"></a></li>
</ul>
<p>Â 
Â </p>
<h2 id="introduction">Introduction</h2>
<p>This turorial intends to demostrate the first portion WiFi penetration testing using Airmon-ng manually to capture WPA2 handshake by showing each step of the processwith pictures. This turoial will not demostarate cracking the captured WPA2 hashed WiFi password. Pt.2 of the tutorial demostrate how to crack the captured hashed WiFi password of the test network.</p>
<p>Some familitarity with using command prompt, powershell, terminal, bash, etc&hellip; and knolwedge of WiFi standards is advised before following this guide.</p>
<p>Preparing and setting up a Kali Linux enviornment for penetration  testing is not apart of this turotial, and therefore this guide omits the process of setting a work enviornment.</p>
<p>Â 
Â </p>
<h2 id="0-pre-preparation">0. Pre-preparation</h2>
<p>Â 
Â </p>
<h3 id="0-1-pre-preparation-reading">0-1 Pre-preparation Reading</h3>
<p><a href="https://youtu.be/WfYxrLaqlN8">Cracking WiFi WPA2 Handshake by David Bombal - Youtube</a></p>
<p><a href="https://yewtu.be/watch?v=uKZb3D-PHS0">Advanced WiFi Scanning with Aircrack-NG with HAK5 </a></p>
<p>Aircrack-ng Tools documentation</p>
<ul>
<li>
<p><a href="https://aircrack-ng.org/doku.php?id=airodump-ng">https://aircrack-ng.org/doku.php?id=airodump-ng</a></p>
</li>
<li>
<p><a href="https://aircrack-ng.org/doku.php?id=aireplay-ng">https://aircrack-ng.org/doku.php?id=aireplay-ng</a></p>
</li>
<li>
<p><a href="https://aircrack-ng.org/doku.php?id=deauthentication">https://aircrack-ng.org/doku.php?id=deauthentication</a></p>
</li>
</ul>
<p><a href="/posts/guide-flash-kali-linux-image-onto-usb-flash-drive-windows-10/">Flash Kali Linux Image onto USB Flash drive on Windows 10 PC - Guide</a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Â 
Â </p>
<h3 id="0-2-acquire-necessary-devices">0-2 Acquire necessary devices</h3>
<p>Compatible WiFi Adpaters</p>
<ol>
<li><a href="https://github.com/morrownr/USB-WiFi/blob/main/home/USB_WiFi_Adapter_Information_for_Linux.md">USB WiFi Adapter Information for Linux by morrownr on GitHub</a></li>
<li><a href="https://github.com/morrownr/USB-WiFi/blob/main/home/USB_WiFi_Adapters_that_are_supported_with_Linux_in-kernel_drivers.md">USB WiFi Adapters that are supported with Linux in-kernel drivers by morrownr on GitHub</a></li>
</ol>
<p>Computer - to run Kali Linux</p>
<ul>
<li>Can either be installed on computer, boot into a live USB flashdrive, or ran in a virtual machine.</li>
</ul>
<p>WiFi Router - sanitized network dedicated specifically for penetration testing</p>
<p>Phone or Tablet - for connecting to test network</p>
<p>Â 
Â </p>
<h3 id="0-3-notes">0-3 Notes</h3>
<ul>
<li>
<p>Setup the Wifi Router that you will be using for this penetration test.</p>
</li>
<li>
<p>Connect your phone or tablet to the WiFi router after it is set up.</p>
</li>
<li>
<p><strong>Note:</strong> that the WiFi router does not require internet connection for you to conduct this penetration test.</p>
</li>
<li>
<p><strong>Note:</strong> this turorial uses a live disc of Kali Linux being ran on a laptop. Internal WiFi card will be wlan0. WiFi adapter will be wlan1.</p>
</li>
</ul>
<p>Â 
Â </p>
<h2 id="1-enable-monitor-mode">1. Enable Monitor Mode</h2>
<ol>
<li>Open a terminal window. Keyboard shortcut to open a terminal window is:</li>
</ol>
<pre tabindex="0"><code>Ctrl key + AlT key + T key pressed all at same time = terminal window opens
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/enable_mon_1.png" alt="enable mon"></p>
<ol start="2">
<li>Check and verify the WiFi adpter fully plugged in and is recognized by the OS(Kali). Also find the assigned name of the WiFi adpator. Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>iwconfig
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/enable_mon_2.png" alt="enable mon"></p>
<ol start="3">
<li>Start Airmon-ng. This command will start airmon-ng and kill all network activity and conections. Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>sudo airmon-ng check kill
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/enable_mon_3.png" alt="enable mon"></p>
<ol start="4">
<li>Swtich the WiFi adapter to monitor mode with Airmon-ng. WiFI devices are in managed mode by default, and it&rsquo;s purpose is to connect to networks. Monitor mode&rsquo;s purpose is to perform passive capture, without joining a network. Monitor switches the Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>sudo airmon-ng start wlan1
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/enable_mon_4.png" alt="enable mon"></p>
<ol start="5">
<li>Check and verify the WiFi adpter is now recognized as &ldquo;wlan1mon&rdquo; by Airmon-ng. The -mon suffix at the end of wlan1 indicates the WiFI adpater is now in monitor mode. Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>sudo airmon-ng 
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/enable_mon_5.png" alt="enable mon"></p>
<ol start="6">
<li>Check and verify the WiFi adpter is now recognized as &ldquo;wlan1mon&rdquo; by the OS(Kali). The -mon suffix at the end of wlan1 indicates the WiFI adpater is now in monitor mode. Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>iwconfig
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/enable_mon_6.png" alt="enable mon"></p>
<p>Â 
Â </p>
<h2 id="2-scan-for-networks">2. Scan for Networks</h2>
<ul>
<li>To scan 2.4GHz WiFi networks. Airodump-ng is apart of the Airmon-ng suite of tools. Airmon-ng by default scans for 2.4GHz radio band networks. 2.4GHz radio band is long-range. 2.4GHz radio band is often filled with intereference from other non-WiFi router devics (ex:Security Cameras, Bluetooth devices, Big home appliances, R/C drones &amp; cars, and other wireless devices). Type the command below into the terminal:</li>
</ul>
<pre tabindex="0"><code>sudo airodump-ng wlan1mon
</code></pre><ul>
<li>To scan 5GHz WiFi networks. Airodump-ng is apart of the Airmon-ng suite of tools. The additon of &ldquo;&ndash;band a&rdquo; after the &ldquo;airodump-ng wlan1mon&rdquo; command switches airmon-ng to scanf for 5GHz radio band networks. 5GHz radio band is short-range. 5GHz WiFi is significantly faster and has more bandwidth than 2.4GHz WiFi.</li>
</ul>
<pre tabindex="0"><code>sudo airodump-ng wlan1mon --band a
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/scan_networks_1.1.png" alt="scan networks">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/scan_networks_1.2.png" alt="scan networks"></p>
<ul>
<li>After you have found your test network (WiFi router) and saved the BSSID (for later reference) kill the process running in the terminal. BSSID is the MAC address of the routers. Keyboard shortcut to kill process in terminal is:</li>
</ul>
<pre tabindex="0"><code>Ctrl key + C key pressed all at same time = kill current running process
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/scan_networks_1.3.png" alt="scan networks"></p>
<p>Â 
Â </p>
<h2 id="3-scan-test-network">3. Scan Test Network</h2>
<ol>
<li>Verify that the BSSID you have saved is for your test WiFi Router. Connect to it and see that the only device connected to it is your phone or tablet. In this example we will target the 5GHz Wifi. Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>sudo airodump-ng wlan1mon --band a --bssid bssid:number:goes:here
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/scan_test_network_1.1.png" alt="scan test network">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/scan_test_network_1.2.png" alt="scan test network"></p>
<ol start="2">
<li>
<p>Save/note the channel the test router operates on.</p>
</li>
<li>
<p>After you have verified you are connected to your test WiFi router, kill the process running in the terminal. Keyboard shortcut to kill process in terminal is:</p>
</li>
</ol>
<pre tabindex="0"><code>Ctrl key + C key pressed all at same time = kill current running process
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/scan_test_network_3.png" alt="scan test network"></p>
<p>Â 
Â </p>
<h2 id="4-capture-test-network-wpa2-handshake">4. Capture Test Network WPA2 Handshake</h2>
<ol>
<li>Run airodump-ng to capture connections made between the test network and connected. Type the command below into the terminal:</li>
</ol>
<pre tabindex="0"><code>sudo airodump-ng wlan1mon --band a --channel 149 --write home/kali/Documents/test1 --bssid bssid:number:goes:here
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_1.1.png" alt="capture handshake">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_1.2.png" alt="capture handshake">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_1.3.png" alt="capture handshake"></p>
<ol start="2">
<li>
<p>Open a new terminal tab to run another airodump-ng script simultaneously.
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_2.png" alt="capture handshake"></p>
</li>
<li>
<p>Deauthenticate (kick off) all connected devices from the test router to force the devices to reconnect to the test router so the airodump-ng script running to capture connections in the other terminal tab (step 1) can capture the WPA2 4-way handshake between the test router and the device. Type the command below into the terminal:</p>
</li>
</ol>
<pre tabindex="0"><code>sudo aireplay-ng wlan1mon --deauth 0 -a bssid:number:goes:here
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_3.1.png" alt="capture handshake">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_3.2.png" alt="capture handshake"></p>
<ol start="4">
<li>
<p>Navigate to the 1st tab(step 1) and the top of the terminal until it displays the message &ldquo;[ WPA handshake: bssid:number:displayed:here]&rdquo; to the right of the date and time.
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_4.png" alt="capture handshake"></p>
</li>
<li>
<p>After you have verified that the airodump-ng script running to capture connections has captured the WPA2 4-way handshake, kill the process running in both terminal tabs. Keyboard shortcut to kill process in terminal is:</p>
</li>
</ol>
<pre tabindex="0"><code>Ctrl key + C key pressed all at same time = kill current running process
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_5.1.png" alt="capture handshake">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/cap_handshake_5.2.png" alt="capture handshake"></p>
<h2 id="5-verify-the-captured-wpa2-handshake">5. Verify the captured WPA2 handshake</h2>
<ol>
<li>
<p>Navigate to the Documents folder.
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/verify_cap_1.png" alt="verify cap"></p>
</li>
<li>
<p>Double click on the &ldquo;test01-01.cap&rdquo; to open the file in Wireshark.
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/verify_cap_2.1.png" alt="verify cap">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/verify_cap_2.2.png" alt="verify cap"></p>
</li>
<li>
<p>In Wireshark, type &ldquo;eapol&rdquo; into the Wireshark search bar and press the enter key.</p>
</li>
</ol>
<pre tabindex="0"><code>eapol + Enter key =  shows all 802.1X authentication protocol packets caputred
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/verify_cap_3.1.png" alt="verify cap">
<img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/verify_cap_3.2.png" alt="verify cap"></p>
<p>Â 
Â </p>
<h2 id="6-stop-monitor-mode-on-wifi-adapter">6. Stop Monitor Mode on WiFi adapter</h2>
<p>When finished with the process of capturing the WPA2 4-way handshake between the test router and the device, turn off monitor mode and switch the WiFi adapter to managed mode. Type the command below into the terminal:</p>
<pre tabindex="0"><code>sudo airmon-ng stop wlan1mon
</code></pre><p><img src="/Pentest_Kali_Wifi_Airmon-ng_Pt1/stop_mon_mode_1.png" alt="stop mon mode"></p>
<p>Â 
Â </p>
<h2 id="go-to-the-pt2-tutorial-to-learn-how-to-crack-the-captured-wpa2-hashed-wifi-password-coming-soon">Go to the Pt.2 tutorial to learn how to crack the captured WPA2 hashed WiFi password. Coming soon&hellip;</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Â 
Â </p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
